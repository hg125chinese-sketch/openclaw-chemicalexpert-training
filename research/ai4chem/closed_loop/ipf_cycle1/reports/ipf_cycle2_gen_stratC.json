{
  "device": "cuda",
  "n_pairs": 286,
  "mol_vocab_size": 34,
  "frag_vocab_size": 19,
  "mol_max_len": 88,
  "frag_max_len": 21,
  "example_pairs": [
    {
      "molecule": "COCC(=O)Nc1cc(Oc2ccc(NC(=O)Nc3cc(C4(C)COC4)nn3-c3ccc(C)cc3)cc2)ccn1",
      "fragment": "CNc1cc(O)ccn1"
    },
    {
      "molecule": "C=CCN(C)c1nccc(Nc2cc(NC(=O)c3ccnc(N4CCOCC4)c3)ccc2C)n1",
      "fragment": "Cc1ccnc(N(C)C)c1"
    },
    {
      "molecule": "Cc1ccc(NC(=O)c2ccnc(N3CCOCC3)c2)cc1-n1c(C)nc2ccc(N3CCN(C)CC3)cc2c1=O",
      "fragment": "Cc1ccnc(N(C)C)c1"
    },
    {
      "molecule": "COC(=O)Nc1cc(Oc2ccc(NC(=O)Nc3cc(C4(C)CSC4)nn3-c3ccc(C)cc3)cc2)ccn1",
      "fragment": "CNc1cc(O)ccn1"
    },
    {
      "molecule": "Cc1ccc(-n2nc(C(C)(C)C)cc2NC(=O)Nc2ncc(CCc3ccnc(NC(=O)C(C)C)c3)s2)cc1",
      "fragment": "CNc1cc(C)ccn1"
    }
  ],
  "train_history": {
    "history": [
      {
        "epoch": 1,
        "recon_loss": 3.3272550900777182,
        "kl_loss": 8.0,
        "beta_last": 0.17777777777777778,
        "kl_total": 0.9003106951713562,
        "kl_per_dim_mean": 0.02813470922410488,
        "active_units": 23,
        "total_dims": 32,
        "au_ratio": 0.71875
      },
      {
        "epoch": 2,
        "recon_loss": 2.8789378801981607,
        "kl_loss": 8.0,
        "beta_last": 0.4444444444444444,
        "kl_total": 3.123595714569092,
        "kl_per_dim_mean": 0.09761236608028412,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 3,
        "recon_loss": 2.6080876191457114,
        "kl_loss": 8.023770014444986,
        "beta_last": 0.7111111111111111,
        "kl_total": 4.619231224060059,
        "kl_per_dim_mean": 0.14435097575187683,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 4,
        "recon_loss": 2.4696031411488852,
        "kl_loss": 8.02370548248291,
        "beta_last": 0.9777777777777777,
        "kl_total": 4.043249130249023,
        "kl_per_dim_mean": 0.12635153532028198,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 5,
        "recon_loss": 2.325111230214437,
        "kl_loss": 8.000062624613443,
        "beta_last": 1.0,
        "kl_total": 3.390866279602051,
        "kl_per_dim_mean": 0.10596457123756409,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 6,
        "recon_loss": 2.2567551930745444,
        "kl_loss": 8.001402537027994,
        "beta_last": 1.0,
        "kl_total": 2.9706594944000244,
        "kl_per_dim_mean": 0.09283310920000076,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 7,
        "recon_loss": 2.1595598061879477,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 2.9549832344055176,
        "kl_per_dim_mean": 0.09234322607517242,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 8,
        "recon_loss": 2.155933062235514,
        "kl_loss": 8.002052307128906,
        "beta_last": 0.044444444444444446,
        "kl_total": 2.8166286945343018,
        "kl_per_dim_mean": 0.08801964670419693,
        "active_units": 30,
        "total_dims": 32,
        "au_ratio": 0.9375
      },
      {
        "epoch": 9,
        "recon_loss": 2.099373976389567,
        "kl_loss": 8.00013001759847,
        "beta_last": 0.3111111111111111,
        "kl_total": 2.695970058441162,
        "kl_per_dim_mean": 0.08424906432628632,
        "active_units": 30,
        "total_dims": 32,
        "au_ratio": 0.9375
      },
      {
        "epoch": 10,
        "recon_loss": 2.1141194502512612,
        "kl_loss": 8.000013669331869,
        "beta_last": 0.5777777777777777,
        "kl_total": 2.663771629333496,
        "kl_per_dim_mean": 0.08324286341667175,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 11,
        "recon_loss": 2.0077277024586997,
        "kl_loss": 8.000306447347006,
        "beta_last": 0.8444444444444444,
        "kl_total": 2.6793670654296875,
        "kl_per_dim_mean": 0.08373022079467773,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 12,
        "recon_loss": 2.0709559122721353,
        "kl_loss": 8.00005849202474,
        "beta_last": 1.0,
        "kl_total": 2.5437519550323486,
        "kl_per_dim_mean": 0.0794922485947609,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 13,
        "recon_loss": 2.0552257696787515,
        "kl_loss": 8.000010172526041,
        "beta_last": 1.0,
        "kl_total": 2.4673242568969727,
        "kl_per_dim_mean": 0.0771038830280304,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 14,
        "recon_loss": 1.9538098573684692,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 2.5079362392425537,
        "kl_per_dim_mean": 0.0783730074763298,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 15,
        "recon_loss": 1.969019095102946,
        "kl_loss": 8.000005086263021,
        "beta_last": 1.0,
        "kl_total": 2.6510114669799805,
        "kl_per_dim_mean": 0.08284410834312439,
        "active_units": 29,
        "total_dims": 32,
        "au_ratio": 0.90625
      },
      {
        "epoch": 16,
        "recon_loss": 1.9264739751815796,
        "kl_loss": 8.001905759175619,
        "beta_last": 0.17777777777777778,
        "kl_total": 2.747832775115967,
        "kl_per_dim_mean": 0.08586977422237396,
        "active_units": 27,
        "total_dims": 32,
        "au_ratio": 0.84375
      },
      {
        "epoch": 17,
        "recon_loss": 1.8900562922159831,
        "kl_loss": 8.000555674235025,
        "beta_last": 0.4444444444444444,
        "kl_total": 2.566819667816162,
        "kl_per_dim_mean": 0.08021311461925507,
        "active_units": 27,
        "total_dims": 32,
        "au_ratio": 0.84375
      },
      {
        "epoch": 18,
        "recon_loss": 1.8765506347020466,
        "kl_loss": 8.0001589457194,
        "beta_last": 0.7111111111111111,
        "kl_total": 2.412308692932129,
        "kl_per_dim_mean": 0.07538464665412903,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 19,
        "recon_loss": 1.8368888298670452,
        "kl_loss": 8.0,
        "beta_last": 0.9777777777777777,
        "kl_total": 2.409085273742676,
        "kl_per_dim_mean": 0.07528391480445862,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 20,
        "recon_loss": 1.8707501888275146,
        "kl_loss": 8.000025431315104,
        "beta_last": 1.0,
        "kl_total": 2.4152517318725586,
        "kl_per_dim_mean": 0.07547661662101746,
        "active_units": 28,
        "total_dims": 32,
        "au_ratio": 0.875
      },
      {
        "epoch": 21,
        "recon_loss": 1.8132650057474773,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 2.5554373264312744,
        "kl_per_dim_mean": 0.07985741645097733,
        "active_units": 29,
        "total_dims": 32,
        "au_ratio": 0.90625
      },
      {
        "epoch": 22,
        "recon_loss": 1.8496832450230916,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 2.7206687927246094,
        "kl_per_dim_mean": 0.08502089977264404,
        "active_units": 29,
        "total_dims": 32,
        "au_ratio": 0.90625
      },
      {
        "epoch": 23,
        "recon_loss": 1.7815494139989216,
        "kl_loss": 8.0,
        "beta_last": 0.044444444444444446,
        "kl_total": 2.990978717803955,
        "kl_per_dim_mean": 0.0934680849313736,
        "active_units": 29,
        "total_dims": 32,
        "au_ratio": 0.90625
      },
      {
        "epoch": 24,
        "recon_loss": 1.7680986324946086,
        "kl_loss": 8.001008987426758,
        "beta_last": 0.3111111111111111,
        "kl_total": 3.2732231616973877,
        "kl_per_dim_mean": 0.10228822380304337,
        "active_units": 29,
        "total_dims": 32,
        "au_ratio": 0.90625
      },
      {
        "epoch": 25,
        "recon_loss": 1.802689750989278,
        "kl_loss": 8.000662167867025,
        "beta_last": 0.5777777777777777,
        "kl_total": 3.2536730766296387,
        "kl_per_dim_mean": 0.10167728364467621,
        "active_units": 31,
        "total_dims": 32,
        "au_ratio": 0.96875
      },
      {
        "epoch": 26,
        "recon_loss": 1.7140334447224934,
        "kl_loss": 8.000011444091797,
        "beta_last": 0.8444444444444444,
        "kl_total": 3.4231207370758057,
        "kl_per_dim_mean": 0.10697252303361893,
        "active_units": 31,
        "total_dims": 32,
        "au_ratio": 0.96875
      },
      {
        "epoch": 27,
        "recon_loss": 1.6960227092107136,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 3.72356915473938,
        "kl_per_dim_mean": 0.11636153608560562,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 28,
        "recon_loss": 1.7386774619420369,
        "kl_loss": 8.00058396657308,
        "beta_last": 1.0,
        "kl_total": 3.85909104347229,
        "kl_per_dim_mean": 0.12059659510850906,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 29,
        "recon_loss": 1.6513659159342449,
        "kl_loss": 8.000686327616373,
        "beta_last": 1.0,
        "kl_total": 3.8376271724700928,
        "kl_per_dim_mean": 0.1199258491396904,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      },
      {
        "epoch": 30,
        "recon_loss": 1.626518448193868,
        "kl_loss": 8.0,
        "beta_last": 1.0,
        "kl_total": 3.9413070678710938,
        "kl_per_dim_mean": 0.12316584587097168,
        "active_units": 32,
        "total_dims": 32,
        "au_ratio": 1.0
      }
    ],
    "final_diagnostics": {
      "kl_total": 3.9413070678710938,
      "kl_per_dim_mean": 0.12316584587097168,
      "active_units": 32,
      "total_dims": 32,
      "au_ratio": 1.0
    }
  },
  "generation": {
    "by_condition": {
      "aminopyrimidine": {
        "fragment": "Nc1nccnc1",
        "n_unique": 54
      },
      "aminopyridine": {
        "fragment": "Nc1ccccn1",
        "n_unique": 63
      },
      "pyrazole": {
        "fragment": "[nH]1ccnc1",
        "n_unique": 67
      }
    },
    "n_total_unique": 184
  },
  "validate_generation": {
    "n_generated": 184,
    "n_valid": 184,
    "n_unique": 184,
    "validity_pct": 100.0,
    "uniqueness_pct": 100.0,
    "novelty_pct": 100.0,
    "hinge_coverage_pct": 65.8,
    "train_hinge_pct": 47.7,
    "coverage_ratio": 1.379,
    "internal_diversity": 0.759,
    "gate_results": {
      "validity": {
        "value": 100.0,
        "threshold": 85.0,
        "pass": true
      },
      "hinge_coverage_ratio": {
        "value": 1.3792128683980158,
        "threshold": 0.3,
        "pass": true
      }
    },
    "all_gates_passed": true
  },
  "model_saved": true,
  "model_path": "research/ai4chem/closed_loop/ipf_cycle1/models/selfies_vae_cycle2_stratC.pt"
}